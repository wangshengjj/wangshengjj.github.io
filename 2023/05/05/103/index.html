<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>【Linux存储系列教程】glusterfs分布式文件系统 | WangShengJJのblog</title><meta name="author" content="网笙久久"><meta name="copyright" content="网笙久久"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="【Linux存储系列教程】glusterfs分布式文件系统一、关于分布式文件系统 作用： 适用于海量数据 增加数据的处理速度   构建分布式文件存储系统常见的软件： hadoop, hdfs【大数据】 glusterfs【云平台】 ceph【现在比较流行】    1.gluster的特性 开源的 容量达到PB级、服务器的最多达到千台   提升数据读写速度、高用性 无元数据metadata的架构,">
<meta property="og:type" content="article">
<meta property="og:title" content="【Linux存储系列教程】glusterfs分布式文件系统">
<meta property="og:url" content="https://blog.wangshengjj.work/2023/05/05/103/index.html">
<meta property="og:site_name" content="WangShengJJのblog">
<meta property="og:description" content="【Linux存储系列教程】glusterfs分布式文件系统一、关于分布式文件系统 作用： 适用于海量数据 增加数据的处理速度   构建分布式文件存储系统常见的软件： hadoop, hdfs【大数据】 glusterfs【云平台】 ceph【现在比较流行】    1.gluster的特性 开源的 容量达到PB级、服务器的最多达到千台   提升数据读写速度、高用性 无元数据metadata的架构,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://api.ghser.com/random/api.php">
<meta property="article:published_time" content="2023-05-05T09:07:44.343Z">
<meta property="article:modified_time" content="2023-05-05T12:28:08.284Z">
<meta property="article:author" content="网笙久久">
<meta property="article:tag" content="集群">
<meta property="article:tag" content="gluster">
<meta property="article:tag" content="分布式文件系统">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://api.ghser.com/random/api.php"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.wangshengjj.work/2023/05/05/103/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【Linux存储系列教程】glusterfs分布式文件系统',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-05 20:28:08'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><meting-js server="netease" type="playlist" id="7386208265" lrc-type="0" volume="0.5" fixed="true" mini="true" order="random" loop="all" autoplay="true" preload="auto" list-folded="true"></meting-js><script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><meta name="generator" content="Hexo 6.1.0"></head><body><link rel="stylesheet" href="/css/barber-shop.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/medias/loading.gif" data-original="https://www.wangshengjj.work/upload/2022/10/touxiang.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">185</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">261</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 博客主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章归档</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.wangshengjj.work/"><i class="fa-fw fa fa-rss"></i><span> 主博客</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://cloud.wangshengjj.work/"><i class="fa-fw fa fa-cloud"></i><span> 云盘</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://start.wangshengjj.work/"><i class="fa-fw fa fa-paper-plane"></i><span> 起始页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://space.bilibili.com/219606508/bangumi/"><i class="fa-fw fas fa-video"></i><span> 我的追番</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://home.wangshengjj.work/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://vme50.wangshengjj.work/"><i class="fa-fw fas fa-music"></i><span> V我50</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://api.ghser.com/random/api.php')"><nav id="nav"><span id="blog-info"><a href="/" title="WangShengJJのblog"><span class="site-name">WangShengJJのblog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 博客主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章归档</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.wangshengjj.work/"><i class="fa-fw fa fa-rss"></i><span> 主博客</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://cloud.wangshengjj.work/"><i class="fa-fw fa fa-cloud"></i><span> 云盘</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://start.wangshengjj.work/"><i class="fa-fw fa fa-paper-plane"></i><span> 起始页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://space.bilibili.com/219606508/bangumi/"><i class="fa-fw fas fa-video"></i><span> 我的追番</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://home.wangshengjj.work/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://vme50.wangshengjj.work/"><i class="fa-fw fas fa-music"></i><span> V我50</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【Linux存储系列教程】glusterfs分布式文件系统</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-05T09:07:44.343Z" title="发表于 2023-05-05 17:07:44">2023-05-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-05-05T12:28:08.284Z" title="更新于 2023-05-05 20:28:08">2023-05-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/">服务器搭建</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/%E7%AC%94%E8%AE%B0/">笔记</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/%E7%AC%94%E8%AE%B0/linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/">linux基础服务</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/%E7%AC%94%E8%AE%B0/linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/%E9%9B%86%E7%BE%A4/">集群</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/%E7%AC%94%E8%AE%B0/linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/%E9%9B%86%E7%BE%A4/%E5%AD%98%E5%82%A8/">存储</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA/%E7%AC%94%E8%AE%B0/linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/%E9%9B%86%E7%BE%A4/%E5%AD%98%E5%82%A8/gluster/">gluster</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>22分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【Linux存储系列教程】glusterfs分布式文件系统"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="【Linux存储系列教程】glusterfs分布式文件系统"><a href="#【Linux存储系列教程】glusterfs分布式文件系统" class="headerlink" title="【Linux存储系列教程】glusterfs分布式文件系统"></a>【Linux存储系列教程】glusterfs分布式文件系统</h1><h2 id="一、关于分布式文件系统"><a href="#一、关于分布式文件系统" class="headerlink" title="一、关于分布式文件系统"></a>一、关于分布式文件系统</h2><ul>
<li>作用：<ul>
<li>适用于海量数据</li>
<li>增加数据的处理速度</li>
</ul>
</li>
<li>构建分布式文件存储系统常见的软件：<ul>
<li>hadoop, hdfs【大数据】</li>
<li>glusterfs【云平台】</li>
<li>ceph【现在比较流行】</li>
</ul>
</li>
</ul>
<h3 id="1-gluster的特性"><a href="#1-gluster的特性" class="headerlink" title="1.gluster的特性"></a>1.gluster的特性</h3><ul>
<li>开源的</li>
<li>容量达到PB级、服务器的最多达到千台  </li>
<li>提升数据读写速度、高用性</li>
<li>无元数据metadata的架构, 采用弹性hash定位数据</li>
<li>可以廉价的pc server上构建</li>
</ul>
<h3 id="2-gluster的结构"><a href="#2-gluster的结构" class="headerlink" title="2.gluster的结构"></a>2.gluster的结构</h3><blockquote>
<p><strong><code>brick</code>真实的存储空间，表现为磁盘挂载点</strong><br><strong><code>volume</code>虚拟的存储空间，用于前端业务挂载使用</strong></p>
</blockquote>
<p><img src="/medias/loading.gif" data-original="https://www.wsjj.top/upload/2023/05/gluster01.png" alt="gluster01"></p>
<h2 id="二、安装gluster分布式文件系统集群"><a href="#二、安装gluster分布式文件系统集群" class="headerlink" title="二、安装gluster分布式文件系统集群"></a>二、安装gluster分布式文件系统集群</h2><blockquote>
<p><strong>准备：<code>5</code>台虚拟机，<code>master</code>节点用于挂载后端<code>node</code>节点的<code>volume</code>，每台<code>node</code>节点添加<code>4</code>块虚拟硬盘</strong><br><strong>master01.linux.com 192.168.140.10</strong><br><strong>node1.linux.com 192.168.140.12</strong><br><strong>node2.linux.com 192.168.140.13</strong><br><strong>node3.linux.com 192.168.140.14</strong><br><strong>node4.linux.com 192.168.140.15</strong><br><strong>注：添加虚拟硬盘的时候，虚拟机应处于关机状态！</strong></p>
</blockquote>
<p><img src="/medias/loading.gif" data-original="https://www.wsjj.top/upload/2023/05/gluster02.png" alt="gluster02"></p>
<h3 id="1-关闭防火墙和SElinux、设置时间同步"><a href="#1-关闭防火墙和SElinux、设置时间同步" class="headerlink" title="1.关闭防火墙和SElinux、设置时间同步"></a>1.关闭防火墙和SElinux、设置时间同步</h3><blockquote>
<p><strong>过程省略</strong></p>
</blockquote>
<h3 id="2-配置免密SSH"><a href="#2-配置免密SSH" class="headerlink" title="2.配置免密SSH"></a>2.配置免密SSH</h3><blockquote>
<p><strong>在<code>node1</code>上操作</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# ssh-keygen -t rsa
Generating public&#x2F;private rsa key pair.
Enter file in which to save the key (&#x2F;root&#x2F;.ssh&#x2F;id_rsa): 
&#x2F;root&#x2F;.ssh&#x2F;id_rsa already exists.
Overwrite (y&#x2F;n)? y
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in &#x2F;root&#x2F;.ssh&#x2F;id_rsa.
Your public key has been saved in &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub.
The key fingerprint is:
SHA256:OG9ejEMDAz5S1uZbHkeU888zKWL7PmUSEKTqrsZmmLo root@node1
The key&#39;s randomart image is:
+---[RSA 2048]----+
|    +.   o+o     |
|   + .o  .&#x3D;      |
|  . ooo .. +     |
|   . ..&#x3D;o . o    |
|      ++So   + . |
|     ..+.+o o O  |
|   +  . &#x3D;.oo &#x3D; o |
|  o &#x3D;. o o. .    |
|Eo +... .  oo.   |
+----[SHA256]-----+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# mv &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub &#x2F;root&#x2F;.ssh&#x2F;authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# scp -r &#x2F;root&#x2F;.ssh&#x2F; root@192.168.140.10:&#x2F;root&#x2F;
[root@node1 ~]# scp -r &#x2F;root&#x2F;.ssh&#x2F; root@192.168.140.13:&#x2F;root&#x2F;
[root@node1 ~]# scp -r &#x2F;root&#x2F;.ssh&#x2F; root@192.168.140.14:&#x2F;root&#x2F;
[root@node1 ~]# scp -r &#x2F;root&#x2F;.ssh&#x2F; root@192.168.140.15:&#x2F;root&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-配置主机名解析"><a href="#3-配置主机名解析" class="headerlink" title="3.配置主机名解析"></a>3.配置主机名解析</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# vim &#x2F;etc&#x2F;hosts

127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.140.10          master01.linux.com
192.168.140.12          node1.linux.com
192.168.140.13          node2.linux.com
192.168.140.14          node3.linux.com
192.168.140.15          node4.linux.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="把hosts文件拷贝给其他主机"><a href="#把hosts文件拷贝给其他主机" class="headerlink" title="把hosts文件拷贝给其他主机"></a>把<code>hosts</code>文件拷贝给其他主机</h4><blockquote>
<p><strong>利用<code>for</code>循环快速拷贝过去</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# for i in 10 13 14 15
&gt; do
&gt; scp &#x2F;etc&#x2F;hosts root@192.168.140.$i:&#x2F;etc&#x2F;
&gt; done
hosts                                                   100%  322    91.2KB&#x2F;s   00:00    
hosts                                                   100%  322   132.7KB&#x2F;s   00:00    
hosts                                                   100%  322   130.7KB&#x2F;s   00:00    
hosts                                                   100%  322    96.9KB&#x2F;s   00:00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-配置gluster软件仓库"><a href="#4-配置gluster软件仓库" class="headerlink" title="4.配置gluster软件仓库"></a>4.配置gluster软件仓库</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# vim &#x2F;etc&#x2F;yum.repos.d&#x2F;gluster.repo
[gluster6]
name&#x3D;gluster6
baseurl&#x3D;https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;centos&#x2F;7.9.2009&#x2F;storage&#x2F;x86_64&#x2F;gluster-6
enabled&#x3D;1
gpgcheck&#x3D;0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="把仓库拷贝给其他虚拟机"><a href="#把仓库拷贝给其他虚拟机" class="headerlink" title="把仓库拷贝给其他虚拟机"></a>把仓库拷贝给其他虚拟机</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# for i in 10 13 14 15
&gt; do
&gt; scp &#x2F;etc&#x2F;yum.repos.d&#x2F;gluster.repo root@192.168.140.$i:&#x2F;etc&#x2F;yum.repos.d&#x2F;
&gt; done
gluster.repo                                            100%  122    88.0KB&#x2F;s   00:00    
gluster.repo                                            100%  122   248.6KB&#x2F;s   00:00    
gluster.repo                                            100%  122   196.2KB&#x2F;s   00:00    
gluster.repo                                            100%  122   117.6KB&#x2F;s   00:00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-Node节点安装gluster"><a href="#5-Node节点安装gluster" class="headerlink" title="5.Node节点安装gluster"></a>5.Node节点安装gluster</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# for i in 12 13 14 15
&gt; do
&gt; ssh root@192.168.140.$i yum install -y glusterfs-server glusterfs-fuse glusterfs
&gt; done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="设置开机自启动，并且检查服务运行状态"><a href="#设置开机自启动，并且检查服务运行状态" class="headerlink" title="设置开机自启动，并且检查服务运行状态"></a>设置开机自启动，并且检查服务运行状态</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# for i in 12 13 14 15
&gt; do
&gt; ssh root@192.168.140.$i systemctl enable --now glusterd
&gt; ssh root@192.168.140.$i hostname; systemctl is-active glusterd
&gt; done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-Master节点安装gluster"><a href="#6-Master节点安装gluster" class="headerlink" title="6.Master节点安装gluster"></a>6.Master节点安装gluster</h3><blockquote>
<p><strong>因为我们<code>Master</code>节点只需要挂载<code>volume</code>，不需要提供服务，所以不用安装<code>glusterfs-server</code></strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# yum install -y glusterfs glusterfs-fuse<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="7-创建gluster集群"><a href="#7-创建gluster集群" class="headerlink" title="7.创建gluster集群"></a>7.创建gluster集群</h3><blockquote>
<p><strong>回到<code>Node</code>节点</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# for i in 2 3 4; do gluster peer probe node$i.linux.com; done
peer probe: success. 
peer probe: success. 
peer probe: success.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="查看集群状态"><a href="#查看集群状态" class="headerlink" title="查看集群状态"></a>查看集群状态</h4><blockquote>
<p><strong>任意一台<code>Node</code>节点都可以</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster peer status
Number of Peers: 3

Hostname: node2.linux.com
Uuid: 3525ea43-5105-4fdf-9733-1220b611eac0
State: Peer in Cluster (Connected)	#已连接

Hostname: node3.linux.com
Uuid: d3707ddf-943c-4a09-b6fc-9933c8620835
State: Peer in Cluster (Connected)	#已连接

Hostname: node4.linux.com
Uuid: 73392f76-fc7c-4fd9-809a-1697eeca3c89
State: Peer in Cluster (Connected)	#已连接<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="三、格式化磁盘"><a href="#三、格式化磁盘" class="headerlink" title="三、格式化磁盘"></a>三、格式化磁盘</h2><h3 id="1-格式化所有node节点后添加的4块硬盘"><a href="#1-格式化所有node节点后添加的4块硬盘" class="headerlink" title="1.格式化所有node节点后添加的4块硬盘"></a>1.格式化所有<code>node</code>节点后添加的4块硬盘</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# for i in 12 13 14 15
&gt; do
&gt; ssh root@192.168.140.$i mkfs -t xfs &#x2F;dev&#x2F;sdb
&gt; ssh root@192.168.140.$i mkfs -t xfs &#x2F;dev&#x2F;sdc
&gt; ssh root@192.168.140.$i mkfs -t xfs &#x2F;dev&#x2F;sdd
&gt; ssh root@192.168.140.$i mkfs -t xfs &#x2F;dev&#x2F;sde
&gt; done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-创建挂载点-挂载目录"><a href="#2-创建挂载点-挂载目录" class="headerlink" title="2.创建挂载点(挂载目录)"></a>2.创建挂载点(挂载目录)</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# for i in 12 13 14 15
&gt; do
&gt; ssh root@192.168.140.$i mkdir &#x2F;data&#123;1..4&#125;
&gt; done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-配置永久挂载"><a href="#3-配置永久挂载" class="headerlink" title="3.配置永久挂载"></a>3.配置永久挂载</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# vim &#x2F;etc&#x2F;fstab
&#x2F;dev&#x2F;sdb        &#x2F;data1  xfs defaults 0 0
&#x2F;dev&#x2F;sdc        &#x2F;data2  xfs defaults 0 0
&#x2F;dev&#x2F;sdd        &#x2F;data3  xfs defaults 0 0
&#x2F;dev&#x2F;sde        &#x2F;data4  xfs defaults 0 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# mount -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# df -hT
&#x2F;dev&#x2F;sdb                xfs        20G   33M   20G    1% &#x2F;data1
&#x2F;dev&#x2F;sdc                xfs        20G   33M   20G    1% &#x2F;data2
&#x2F;dev&#x2F;sdd                xfs        20G   33M   20G    1% &#x2F;data3
&#x2F;dev&#x2F;sde                xfs        20G   33M   20G    1% &#x2F;data4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="其他node节点配置永久挂载"><a href="#其他node节点配置永久挂载" class="headerlink" title="其他node节点配置永久挂载"></a>其他<code>node</code>节点配置永久挂载</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# vim &#x2F;etc&#x2F;fstab
&#x2F;dev&#x2F;sdb        &#x2F;data1  xfs defaults 0 0
&#x2F;dev&#x2F;sdc        &#x2F;data2  xfs defaults 0 0
&#x2F;dev&#x2F;sdd        &#x2F;data3  xfs defaults 0 0
&#x2F;dev&#x2F;sde        &#x2F;data4  xfs defaults 0 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# mount -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="四、volume卷类型"><a href="#四、volume卷类型" class="headerlink" title="四、volume卷类型"></a>四、<code>volume</code>卷类型</h2><h3 id="1-分布式卷distributed-volume"><a href="#1-分布式卷distributed-volume" class="headerlink" title="1.分布式卷distributed volume"></a>1.分布式卷<code>distributed volume</code></h3><p><img src="/medias/loading.gif" data-original="https://www.wsjj.top/upload/2023/05/gluster03.png" alt="gluster03"></p>
<ul>
<li>特征: <ul>
<li>以单个文件为单位，分散存储到不同的<code>brick</code>上</li>
</ul>
</li>
<li>适用场景<ul>
<li>海量<code>小文件</code>存储，以增加<code>读写</code>速度</li>
</ul>
</li>
<li>容量<ul>
<li>所有<code>brick</code>之和，无<code>brick</code>数量限制</li>
</ul>
</li>
</ul>
<h4 id="A-创建brick"><a href="#A-创建brick" class="headerlink" title="A.创建brick"></a>A.创建<code>brick</code></h4><blockquote>
<p><strong>过程&#x3D;&#x3D;省略&#x3D;&#x3D;，刚刚我们已经&#x3D;&#x3D;提前&#x3D;&#x3D;创建过了</strong></p>
</blockquote>
<h4 id="B-创建volume卷"><a href="#B-创建volume卷" class="headerlink" title="B.创建volume卷"></a>B.创建<code>volume</code>卷</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume create dis_volume \
&gt; node1.linux.com:&#x2F;data1&#x2F;br1 \
&gt; node2.linux.com:&#x2F;data1&#x2F;br1
volume create: dis_volume: success: please start the volume to access data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="C-启动volume卷"><a href="#C-启动volume卷" class="headerlink" title="C.启动volume卷"></a>C.启动<code>volume</code>卷</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume start dis_volume
volume start: dis_volume: success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="D-查看刚刚创建的volume卷信息"><a href="#D-查看刚刚创建的volume卷信息" class="headerlink" title="D.查看刚刚创建的volume卷信息"></a>D.查看刚刚创建的<code>volume</code>卷信息</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume info dis_volume
 
Volume Name: dis_volume
Type: Distribute
Volume ID: 23331fcc-65a6-4eba-a677-166755832a88
Status: Started
Snapshot Count: 0
Number of Bricks: 2
Transport-type: tcp
Bricks:
Brick1: node1.linux.com:&#x2F;data1&#x2F;br1
Brick2: node2.linux.com:&#x2F;data1&#x2F;br1
Options Reconfigured:
transport.address-family: inet
nfs.disable: on<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="E-查看当前集群存在的volume卷"><a href="#E-查看当前集群存在的volume卷" class="headerlink" title="E.查看当前集群存在的volume卷"></a>E.查看当前集群存在的<code>volume</code>卷</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume list
dis_volume<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="F-Master主机测试挂载"><a href="#F-Master主机测试挂载" class="headerlink" title="F.Master主机测试挂载"></a>F.<code>Master</code>主机测试挂载</h4><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# mkdir &#x2F;test1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# vim &#x2F;etc&#x2F;fstab

node2.linux.com:&#x2F;dis_volume     &#x2F;test1  glusterfs defaults,_netdev 0 0
#前面的节点写任意一个node都可以，只要在同一个集群下就可<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# mount -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="Master测试数据读写"><a href="#Master测试数据读写" class="headerlink" title="Master测试数据读写"></a><code>Master</code>测试数据读写</h5><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# touch &#x2F;test1&#x2F;&#123;1..10&#125;.mp3
[root@master01 ~]# ls &#x2F;test1&#x2F;
10.mp3  1.mp3  2.mp3  3.mp3  4.mp3  5.mp3  6.mp3  7.mp3  8.mp3  9.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="查看后台Node节点存储情况"><a href="#查看后台Node节点存储情况" class="headerlink" title="查看后台Node节点存储情况"></a>查看后台<code>Node</code>节点存储情况</h5><blockquote>
<p><strong>适合海量&#x3D;&#x3D;小文件&#x3D;&#x3D;存储场景</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# ls &#x2F;data1&#x2F;br1&#x2F;
1.mp3  2.mp3  3.mp3  7.mp3  8.mp3

[root@node2 ~]# ls &#x2F;data1&#x2F;br1&#x2F;
10.mp3  4.mp3  5.mp3  6.mp3  9.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-复制卷replicate-volume"><a href="#2-复制卷replicate-volume" class="headerlink" title="2.复制卷replicate volume"></a>2.复制卷<code>replicate volume</code></h3><p><img src="/medias/loading.gif" data-original="https://www.wsjj.top/upload/2023/05/gluster04.png" alt="gluster04"></p>
<ul>
<li>特征<ul>
<li>以单个文件为单位，每个文件会被复制多份存储 </li>
<li>提升数据可靠性</li>
</ul>
</li>
<li>浪费<code>1/2</code>存储空间 </li>
<li><code>replicas</code>指定的复制数量与<code>brick</code>数量一致</li>
</ul>
<h4 id="A-创建brick-1"><a href="#A-创建brick-1" class="headerlink" title="A.创建brick"></a>A.创建<code>brick</code></h4><blockquote>
<p><strong>过程&#x3D;&#x3D;省略&#x3D;&#x3D;，刚刚我们已经提前&#x3D;&#x3D;创建&#x3D;&#x3D;过了</strong></p>
</blockquote>
<h4 id="B-创建volume卷-1"><a href="#B-创建volume卷-1" class="headerlink" title="B.创建volume卷"></a>B.创建<code>volume</code>卷</h4><blockquote>
<p><strong><code>replicas</code>指定的复制数量与<code>brick</code>数量一致</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume create repli_volume replica 3 \
&gt; node1.linux.com:&#x2F;data2&#x2F;br1 \
&gt; node2.linux.com:&#x2F;data2&#x2F;br1 \
&gt; node3.linux.com:&#x2F;data2&#x2F;br1
volume create: repli_volume: success: please start the volume to access data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="C-启动volume卷-1"><a href="#C-启动volume卷-1" class="headerlink" title="C.启动volume卷"></a>C.启动<code>volume</code>卷</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume start repli_volume
volume start: repli_volume: success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="D-查看volume卷信息"><a href="#D-查看volume卷信息" class="headerlink" title="D.查看volume卷信息"></a>D.查看<code>volume</code>卷信息</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume info repli_volume
 
Volume Name: repli_volume
Type: Replicate
Volume ID: 36df6979-e86d-467f-b7dd-9ab399c0717f
Status: Started
Snapshot Count: 0
Number of Bricks: 1 x 3 &#x3D; 3		#每存一份数据，将被复制成3份存到后端brick上
Transport-type: tcp
Bricks:
Brick1: node1.linux.com:&#x2F;data2&#x2F;br1
Brick2: node2.linux.com:&#x2F;data2&#x2F;br1
Brick3: node3.linux.com:&#x2F;data2&#x2F;br1
Options Reconfigured:
transport.address-family: inet
nfs.disable: on
performance.client-io-threads: off<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="E-查看当前集群所有卷组"><a href="#E-查看当前集群所有卷组" class="headerlink" title="E.查看当前集群所有卷组"></a>E.查看当前集群所有卷组</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume list
dis_volume
repli_volume<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="F-Master节点挂载测试"><a href="#F-Master节点挂载测试" class="headerlink" title="F.Master节点挂载测试"></a>F.<code>Master</code>节点挂载测试</h4><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# mkdir &#x2F;test2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# vim &#x2F;etc&#x2F;fstab
node3.linux.com:&#x2F;repli_volume   &#x2F;test2  glusterfs defaults,_netdev 0 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# mount -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="测试数据读写"><a href="#测试数据读写" class="headerlink" title="测试数据读写"></a>测试数据读写</h5><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# touch &#x2F;test2&#x2F;&#123;1..10&#125;.txt
[root@master01 ~]# ls &#x2F;test2
10.txt  1.txt  2.txt  3.txt  4.txt  5.txt  6.txt  7.txt  8.txt  9.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="查看后端Node节点"><a href="#查看后端Node节点" class="headerlink" title="查看后端Node节点"></a>查看后端<code>Node</code>节点</h5><blockquote>
<p><strong>可以看到数据被复制了三份</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# ls &#x2F;data2&#x2F;br1&#x2F;
10.txt  1.txt  2.txt  3.txt  4.txt  5.txt  6.txt  7.txt  8.txt  9.txt
[root@node2 ~]# ls &#x2F;data2&#x2F;br1&#x2F;
10.txt  1.txt  2.txt  3.txt  4.txt  5.txt  6.txt  7.txt  8.txt  9.txt
[root@node3 ~]# ls &#x2F;data2&#x2F;br1&#x2F;
10.txt  1.txt  2.txt  3.txt  4.txt  5.txt  6.txt  7.txt  8.txt  9.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-分布式复制卷Distributed-replicate"><a href="#3-分布式复制卷Distributed-replicate" class="headerlink" title="3.分布式复制卷Distributed-replicate"></a>3.分布式复制卷<code>Distributed-replicate</code></h3><p><img src="/medias/loading.gif" data-original="https://www.wsjj.top/upload/2023/05/gluster05.png" alt="gluster05"></p>
<ul>
<li>特征<ul>
<li>所有文件分散存储，不同的文件再进行复制</li>
</ul>
</li>
<li>适用场景 <ul>
<li>适用于小文件存储，提升可靠性</li>
</ul>
</li>
<li><code>brick</code>数量为<code>replica</code>参数的整倍数</li>
</ul>
<h4 id="A-创建brick-2"><a href="#A-创建brick-2" class="headerlink" title="A.创建brick"></a>A.创建<code>brick</code></h4><blockquote>
<p><strong>过程&#x3D;&#x3D;省略&#x3D;&#x3D;，刚刚我们已经提前&#x3D;&#x3D;创建&#x3D;&#x3D;过了</strong></p>
</blockquote>
<h4 id="B-创建volume卷-2"><a href="#B-创建volume卷-2" class="headerlink" title="B.创建volume卷"></a>B.创建<code>volume</code>卷</h4><blockquote>
<p><strong><code>replicas</code>指定的复制数量与<code>brick</code>数量一致</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume create dis_repli_volume replica 2 \
&gt; node1.linux.com:&#x2F;data3&#x2F;br1 \
&gt; node2.linux.com:&#x2F;data3&#x2F;br1 \
&gt; node3.linux.com:&#x2F;data3&#x2F;br1 \
&gt; node4.linux.com:&#x2F;data3&#x2F;br1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="C-启动volume卷-2"><a href="#C-启动volume卷-2" class="headerlink" title="C.启动volume卷"></a>C.启动<code>volume</code>卷</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume start dis_repli_volume
volume start: dis_repli_volume: success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="D-查看volume卷详细信息"><a href="#D-查看volume卷详细信息" class="headerlink" title="D.查看volume卷详细信息"></a>D.查看<code>volume</code>卷详细信息</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume info dis_repli_volume
 
Volume Name: dis_repli_volume
Type: Distributed-Replicate
Volume ID: aeae303f-51dd-402f-9017-29d00bc9d416
Status: Started
Snapshot Count: 0
Number of Bricks: 2 x 2 &#x3D; 4
Transport-type: tcp
Bricks:
Brick1: node1.linux.com:&#x2F;data3&#x2F;br1
Brick2: node2.linux.com:&#x2F;data3&#x2F;br1
Brick3: node3.linux.com:&#x2F;data3&#x2F;br1
Brick4: node4.linux.com:&#x2F;data3&#x2F;br1
Options Reconfigured:
transport.address-family: inet
nfs.disable: on
performance.client-io-threads: off<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="E-查看当前集群volume卷"><a href="#E-查看当前集群volume卷" class="headerlink" title="E.查看当前集群volume卷"></a>E.查看当前集群<code>volume</code>卷</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume list
dis_repli_volume
dis_volume
repli_volume<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="F-Master节点挂载"><a href="#F-Master节点挂载" class="headerlink" title="F.Master节点挂载"></a>F.Master节点挂载</h4><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# mkdir &#x2F;test3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# vim &#x2F;etc&#x2F;fstab

node1.linux.com:&#x2F;dis_repli_volume       &#x2F;test3  glusterfs defaults,_netdev 0 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# mount -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="测试数据读写-1"><a href="#测试数据读写-1" class="headerlink" title="测试数据读写"></a>测试数据读写</h5><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# touch &#x2F;test3&#x2F;&#123;1..10&#125;.jpg
[root@master01 ~]# ls &#x2F;test3
10.jpg  1.jpg  2.jpg  3.jpg  4.jpg  5.jpg  6.jpg  7.jpg  8.jpg  9.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="查看后端Node节点-1"><a href="#查看后端Node节点-1" class="headerlink" title="查看后端Node节点"></a>查看后端Node节点</h5><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# ls &#x2F;data3&#x2F;br1&#x2F;
2.jpg  4.jpg  6.jpg  7.jpg  8.jpg  9.jpg

[root@node2 ~]# ls &#x2F;data3&#x2F;br1&#x2F;
2.jpg  4.jpg  6.jpg  7.jpg  8.jpg  9.jpg

[root@node3 ~]# ls &#x2F;data3&#x2F;br1&#x2F;
10.jpg  1.jpg  3.jpg  5.jpg

[root@node4 ~]# ls &#x2F;data3&#x2F;br1&#x2F;
10.jpg  1.jpg  3.jpg  5.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-分散卷Disperse"><a href="#4-分散卷Disperse" class="headerlink" title="4.分散卷Disperse"></a>4.分散卷<code>Disperse</code></h3><ul>
<li>特征: <ul>
<li>单个文件会被拆成多部分分散存储， 同时存储数据的校验码</li>
</ul>
</li>
<li>适用场景<ul>
<li>存储大文件，提升速度</li>
</ul>
</li>
<li><code>disperse</code>用于指定<code>brick</code>数量</li>
<li><code>redundany</code>指定用于保存校验码的<code>brick</code>数量，不指定的话，<code>gluster</code>集群会自动选定<code>brick</code>数量用于保存&#x3D;&#x3D;校验码&#x3D;&#x3D;</li>
</ul>
<h4 id="A-创建brick-3"><a href="#A-创建brick-3" class="headerlink" title="A.创建brick"></a>A.创建<code>brick</code></h4><blockquote>
<p><strong>过程&#x3D;&#x3D;省略&#x3D;&#x3D;，刚刚我们已经提前&#x3D;&#x3D;创建&#x3D;&#x3D;过了</strong></p>
</blockquote>
<h4 id="B-创建volume卷-3"><a href="#B-创建volume卷-3" class="headerlink" title="B.创建volume卷"></a>B.创建<code>volume</code>卷</h4><blockquote>
<p><strong><code>disperse</code>要和<code>brick</code>相等</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume create disperse_volume disperse 4 \
&gt; node1.linux.com:&#x2F;data4&#x2F;br1 \
&gt; node2.linux.com:&#x2F;data4&#x2F;br1 \
&gt; node3.linux.com:&#x2F;data4&#x2F;br1 \
&gt; node4.linux.com:&#x2F;data4&#x2F;br1
There isn&#39;t an optimal redundancy value for this configuration. Do you want to create the volume with redundancy 1 ? (y&#x2F;n) y
#如果不手动指定redundany，工具会自动帮我们按照brick的数量划分
volume create: disperse_volume: success: please start the volume to access data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="C-启动volume卷-3"><a href="#C-启动volume卷-3" class="headerlink" title="C.启动volume卷"></a>C.启动<code>volume</code>卷</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume start disperse_volume
volume start: disperse_volume: success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="D-查看volume卷详细信息-1"><a href="#D-查看volume卷详细信息-1" class="headerlink" title="D.查看volume卷详细信息"></a>D.查看<code>volume</code>卷详细信息</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume info disperse_volume
 
Volume Name: disperse_volume
Type: Disperse
Volume ID: c0aa03de-a23a-49d3-a7bc-443e938df5d4
Status: Started
Snapshot Count: 0
Number of Bricks: 1 x (3 + 1) &#x3D; 4	#一份数据会被分成3份，其中另外1份为校验码
Transport-type: tcp
Bricks:
Brick1: node1.linux.com:&#x2F;data4&#x2F;br1
Brick2: node2.linux.com:&#x2F;data4&#x2F;br1
Brick3: node3.linux.com:&#x2F;data4&#x2F;br1
Brick4: node4.linux.com:&#x2F;data4&#x2F;br1
Options Reconfigured:
transport.address-family: inet
nfs.disable: on<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="E-查看当前集群的所有volume卷"><a href="#E-查看当前集群的所有volume卷" class="headerlink" title="E.查看当前集群的所有volume卷"></a>E.查看当前集群的所有<code>volume</code>卷</h4><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume list
dis_repli_volume
dis_volume
disperse_volume
repli_volume<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="F-Master节点挂载-1"><a href="#F-Master节点挂载-1" class="headerlink" title="F.Master节点挂载"></a>F.<code>Master</code>节点挂载</h4><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# mkdir &#x2F;test4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# vim &#x2F;etc&#x2F;fstab

node4.linux.com:&#x2F;disperse_volume        &#x2F;test4  glusterfs defaults,_netdev 0 0
#节点随便哪个都可以，只要在同一个集群下即可<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# mount -a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="测试数据读写-2"><a href="#测试数据读写-2" class="headerlink" title="测试数据读写"></a>测试数据读写</h5><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;test4&#x2F;file01 bs&#x3D;1M count&#x3D;20
[root@master01 ~]# dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;test4&#x2F;file02 bs&#x3D;1M count&#x3D;20
[root@master01 ~]# dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;test4&#x2F;file03 bs&#x3D;1M count&#x3D;20

[root@master01 ~]# ls -lh &#x2F;test4
总用量 61M
-rw-r--r-- 1 root root 20M 5月   5 19:56 file01
-rw-r--r-- 1 root root 20M 5月   5 19:56 file02
-rw-r--r-- 1 root root 20M 5月   5 19:56 file03<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="查看后端Node节点-2"><a href="#查看后端Node节点-2" class="headerlink" title="查看后端Node节点"></a>查看后端<code>Node</code>节点</h5><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# ls -lh &#x2F;data4&#x2F;br1&#x2F;
总用量 22M
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file01
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file02
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file03<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node2 ~]# ls -lh &#x2F;data4&#x2F;br1&#x2F;
总用量 23M
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file01
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file02
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file03<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node3 ~]# ls -lh &#x2F;data4&#x2F;br1&#x2F;
总用量 21M
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file01
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file02
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file03<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node4 ~]# ls -lh &#x2F;data4&#x2F;br1&#x2F;
总用量 23M
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file01
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file02
-rw-r--r-- 2 root root 6.7M 5月   5 19:56 file03<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="五、扩容卷容量"><a href="#五、扩容卷容量" class="headerlink" title="五、扩容卷容量"></a>五、扩容卷容量</h2><h3 id="1-扩展卷容量"><a href="#1-扩展卷容量" class="headerlink" title="1.扩展卷容量"></a>1.扩展卷容量</h3><blockquote>
<p><strong>扩展分布复制卷时，添加的<code>brick</code>数量是<code>replica</code>参数的整倍数</strong></p>
</blockquote>
<h3 id="2-扩容分布式卷"><a href="#2-扩容分布式卷" class="headerlink" title="2.扩容分布式卷"></a>2.扩容分布式卷</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume add-brick dis_volume \
&gt; node3.linux.com:&#x2F;data1&#x2F;br1
volume add-brick: success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>注意扩容卷后，还要<code>rebalance</code>一下，否则新的<code>brick</code>不会存储数据</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume rebalance dis_volume start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>可以使用<code>status</code>查看状态</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume rebalance dis_volume status
                                    Node Rebalanced-files          size       scanned      failures       skipped               status  run time in h:m:s
                               ---------      -----------   -----------   -----------   -----------   -----------         ------------     --------------
                         node2.linux.com                2        0Bytes             5             0             0            completed        0:00:00
                         node3.linux.com                0        0Bytes             0             0             0            completed        0:00:00
                               localhost                2        0Bytes             5             0             0            completed        0:00:00
volume rebalance: dis_volume: success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-Master节点测试"><a href="#3-Master节点测试" class="headerlink" title="3.Master节点测试"></a>3.Master节点测试</h3><pre class="line-numbers language-none"><code class="language-none">[root@master01 ~]# touch &#x2F;test1&#x2F;&#123;1..20&#125;.img
[root@master01 ~]# ls &#x2F;test1
10.img  12.img  15.img  18.img  1.mp3   2.mp3  4.img  5.mp3  7.img  8.mp3
10.mp3  13.img  16.img  19.img  20.img  3.img  4.mp3  6.img  7.mp3  9.img
11.img  14.img  17.img  1.img   2.img   3.mp3  5.img  6.mp3  8.img  9.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-查看后端Node节点"><a href="#4-查看后端Node节点" class="headerlink" title="4.查看后端Node节点"></a>4.查看后端<code>Node</code>节点</h3><blockquote>
<p><strong>可以看到新添的<code>node3</code>已经有数据了</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# ls &#x2F;data1&#x2F;br1&#x2F;
11.img  12.img  13.img  15.img  16.img  17.img  18.img  1.mp3  2.mp3  3.img  5.img  8.mp3
[root@node2 ~]# ls &#x2F;data1&#x2F;br1&#x2F;
10.img  10.mp3  14.img  19.img  20.img  4.mp3  8.img  9.img  9.mp3
[root@node3 ~]# ls &#x2F;data1&#x2F;br1&#x2F;
1.img  2.img  3.mp3  4.img  5.mp3  6.img  6.mp3  7.img  7.mp3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="六、缩减卷容量"><a href="#六、缩减卷容量" class="headerlink" title="六、缩减卷容量"></a>六、缩减卷容量</h2><blockquote>
<p><strong>缩减分布复制卷时，缩减的<code>brick</code>数量是<code>replica</code>参数的整倍数</strong></p>
</blockquote>
<h3 id="1-缩减分布式卷"><a href="#1-缩减分布式卷" class="headerlink" title="1.缩减分布式卷"></a>1.缩减分布式卷</h3><blockquote>
<p><strong>在缩减容量之前，一定要提前&#x3D;&#x3D;转移&#x3D;&#x3D;里面的数据，<code>gluster</code>会自动做转移数据的操作</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume remove-brick dis_volume \
&gt; node3.linux.com:&#x2F;data1&#x2F;br1 start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="2-查看状态"><a href="#2-查看状态" class="headerlink" title="2.查看状态"></a>2.查看状态</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume remove-brick dis_volume node3.linux.com:&#x2F;data1&#x2F;br1 status
                                    Node Rebalanced-files          size       scanned      failures       skipped               status  run time in h:m:s
                               ---------      -----------   -----------   -----------   -----------   -----------         ------------     --------------
                         node3.linux.com                9        0Bytes             9             0             0            completed        0:00:00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-查看卷详细信息"><a href="#3-查看卷详细信息" class="headerlink" title="3.查看卷详细信息"></a>3.查看卷详细信息</h3><blockquote>
<p>此时<code>node3</code>并没有被踢出去</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume info dis_volume
 
Volume Name: dis_volume
Type: Distribute
Volume ID: 23331fcc-65a6-4eba-a677-166755832a88
Status: Started
Snapshot Count: 0
Number of Bricks: 3
Transport-type: tcp
Bricks:
Brick1: node1.linux.com:&#x2F;data1&#x2F;br1
Brick2: node2.linux.com:&#x2F;data1&#x2F;br1
Brick3: node3.linux.com:&#x2F;data1&#x2F;br1
Options Reconfigured:
performance.client-io-threads: on
transport.address-family: inet
nfs.disable: on<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">[root@node3 ~]# ls &#x2F;data1&#x2F;br1&#x2F;
[root@node3 ~]#			#确认node3上面的数据已经转移走了<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="4-提交修改"><a href="#4-提交修改" class="headerlink" title="4.提交修改"></a>4.提交修改</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume remove-brick dis_volume node3.linux.com:&#x2F;data1&#x2F;br1 commit
volume remove-brick commit: success
Check the removed bricks to ensure all files are migrated.
If files with data are found on the brick path, copy them via a gluster mount point before re-purposing the removed brick.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-再次查看卷详细信息"><a href="#5-再次查看卷详细信息" class="headerlink" title="5.再次查看卷详细信息"></a>5.再次查看卷详细信息</h3><blockquote>
<p><strong>此时已经没有<code>node3</code>了</strong></p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume info dis_volume
 
Volume Name: dis_volume
Type: Distribute
Volume ID: 23331fcc-65a6-4eba-a677-166755832a88
Status: Started
Snapshot Count: 0
Number of Bricks: 2
Transport-type: tcp
Bricks:
Brick1: node1.linux.com:&#x2F;data1&#x2F;br1
Brick2: node2.linux.com:&#x2F;data1&#x2F;br1
Options Reconfigured:
performance.client-io-threads: on
transport.address-family: inet
nfs.disable: on<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="七、替换故障卷Replace-faulty-brick"><a href="#七、替换故障卷Replace-faulty-brick" class="headerlink" title="七、替换故障卷Replace faulty brick"></a>七、替换故障卷Replace faulty brick</h2><h3 id="1-替换分布卷的brick"><a href="#1-替换分布卷的brick" class="headerlink" title="1.替换分布卷的brick"></a>1.替换分布卷的brick</h3><ul>
<li>添加新<code>brick</code>(不需要手动<code>rebalance</code>)</li>
<li>删除旧<code>brick</code></li>
</ul>
<h3 id="2-替换旧的故障卷"><a href="#2-替换旧的故障卷" class="headerlink" title="2.替换旧的故障卷"></a>2.替换旧的故障卷</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume replace-brick repli_volume node3.linux.com:&#x2F;data2&#x2F;br1 node4.linux.com:&#x2F;data2&#x2F;br1 commit force<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="3-查看卷详细信息-1"><a href="#3-查看卷详细信息-1" class="headerlink" title="3.查看卷详细信息"></a>3.查看卷详细信息</h3><pre class="line-numbers language-none"><code class="language-none">[root@node1 ~]# gluster volume info repli_volume
 
Volume Name: repli_volume
Type: Replicate
Volume ID: 36df6979-e86d-467f-b7dd-9ab399c0717f
Status: Started
Snapshot Count: 0
Number of Bricks: 1 x 3 &#x3D; 3
Transport-type: tcp
Bricks:
Brick1: node1.linux.com:&#x2F;data2&#x2F;br1
Brick2: node2.linux.com:&#x2F;data2&#x2F;br1
Brick3: node4.linux.com:&#x2F;data2&#x2F;br1
Options Reconfigured:
transport.address-family: inet
nfs.disable: on
performance.client-io-threads: off<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="八、设置卷的参数"><a href="#八、设置卷的参数" class="headerlink" title="八、设置卷的参数"></a>八、设置卷的参数</h2><pre class="line-numbers language-none"><code class="language-none">gluster volume set &lt;VOLNAME&gt; &lt;OPT-NAME&gt; &lt;OPT-VALUE&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="1-常用参数"><a href="#1-常用参数" class="headerlink" title="1.常用参数"></a>1.常用参数</h3><ul>
<li>基于IP地址认证<ul>
<li>auth.allow</li>
<li>auth.reject</li>
</ul>
</li>
<li>performance.write-behind-window-size<ul>
<li>设置写缓冲区Buffer大小，默认1M</li>
</ul>
</li>
<li>performance.io-thread-count<ul>
<li>设置卷的IO线程数量 1–64</li>
</ul>
</li>
<li>performance.cache-size<ul>
<li>设置卷的缓存大小</li>
</ul>
</li>
<li>performance.cache-max-file-size<ul>
<li>设置缓存的最大文件大小</li>
</ul>
</li>
<li>performance.cache-min-file-size<ul>
<li>设置缓存的最小文件大小</li>
</ul>
</li>
<li>performance.cache-refresh-timeout<ul>
<li>设置缓存区的刷新时间间隔, 单位秒</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>更多参数详情请到官网查看：<a target="_blank" rel="noopener" href="https://docs.gluster.org/en/latest/Administrator-Guide/Tuning-Volume-Options/">https://docs.gluster.org/en/latest/Administrator-Guide/Tuning-Volume-Options/</a></strong></p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://blog.wangshengjj.work">网笙久久</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.wangshengjj.work/2023/05/05/103/">https://blog.wangshengjj.work/2023/05/05/103/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.wangshengjj.work" target="_blank">WangShengJJのblog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%9B%86%E7%BE%A4/">集群</a><a class="post-meta__tags" href="/tags/gluster/">gluster</a><a class="post-meta__tags" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">分布式文件系统</a></div><div class="post_share"><div class="social-share" data-image="https://api.ghser.com/random/api.php" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/05/06/104/" title="【Linux存储系列教程】ceph的架构和原理"><img class="cover" src="/medias/loading.gif" data-original="https://api.ghser.com/random/api.php" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【Linux存储系列教程】ceph的架构和原理</div></div></a></div><div class="next-post pull-right"><a href="/2023/05/04/102/" title="【Linux存储系列教程】常见存储类型"><img class="cover" src="/medias/loading.gif" data-original="https://www.dmoe.cc/random.php" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【Linux存储系列教程】常见存储类型</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/04/27/100/" title="【Linux集群系列教程】keepalived高可用集群"><img class="cover" src="/medias/loading.gif" data-original="https://api.ghser.com/random/api.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-27</div><div class="title">【Linux集群系列教程】keepalived高可用集群</div></div></a></div><div><a href="/2023/05/06/104/" title="【Linux存储系列教程】ceph的架构和原理"><img class="cover" src="/medias/loading.gif" data-original="https://api.ghser.com/random/api.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-06</div><div class="title">【Linux存储系列教程】ceph的架构和原理</div></div></a></div><div><a href="/2023/05/06/105/" title="【Linux存储系列教程】ceph-mimic集群部署"><img class="cover" src="/medias/loading.gif" data-original="https://www.dmoe.cc/random.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-06</div><div class="title">【Linux存储系列教程】ceph-mimic集群部署</div></div></a></div><div><a href="/2023/05/06/106/" title="【Linux存储系列教程】ceph存储的使用"><img class="cover" src="/medias/loading.gif" data-original="https://www.dmoe.cc/random.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-06</div><div class="title">【Linux存储系列教程】ceph存储的使用</div></div></a></div><div><a href="/2023/05/08/107/" title="【Linux存储系列教程】zookeeper中间件"><img class="cover" src="/medias/loading.gif" data-original="https://api.ghser.com/random/api.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-05-08</div><div class="title">【Linux存储系列教程】zookeeper中间件</div></div></a></div><div><a href="/2023/04/23/94/" title="【Linux基础服务教程】Redis分片集群"><img class="cover" src="/medias/loading.gif" data-original="https://www.dmoe.cc/random.php" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-23</div><div class="title">【Linux基础服务教程】Redis分片集群</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/medias/loading.gif" data-original="https://www.wangshengjj.work/upload/2022/10/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">网笙久久</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">139</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">185</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">261</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wangshengjj"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wangshengjj" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:wangshengjj@wangshengjj.work" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.wangshengjj.work" target="_blank" title="Blog"><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到网笙久久的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%90Linux%E5%AD%98%E5%82%A8%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B%E3%80%91glusterfs%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">【Linux存储系列教程】glusterfs分布式文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%85%B3%E4%BA%8E%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.</span> <span class="toc-text">一、关于分布式文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-gluster%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.gluster的特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-gluster%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.2.</span> <span class="toc-text">2.gluster的结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85gluster%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%9B%86%E7%BE%A4"><span class="toc-number">1.2.</span> <span class="toc-text">二、安装gluster分布式文件系统集群</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99%E5%92%8CSElinux%E3%80%81%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.关闭防火墙和SElinux、设置时间同步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86SSH"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.配置免密SSH</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AE%E4%B8%BB%E6%9C%BA%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.3.</span> <span class="toc-text">3.配置主机名解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%8Ahosts%E6%96%87%E4%BB%B6%E6%8B%B7%E8%B4%9D%E7%BB%99%E5%85%B6%E4%BB%96%E4%B8%BB%E6%9C%BA"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">把hosts文件拷贝给其他主机</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%85%8D%E7%BD%AEgluster%E8%BD%AF%E4%BB%B6%E4%BB%93%E5%BA%93"><span class="toc-number">1.2.4.</span> <span class="toc-text">4.配置gluster软件仓库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%8A%E4%BB%93%E5%BA%93%E6%8B%B7%E8%B4%9D%E7%BB%99%E5%85%B6%E4%BB%96%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">把仓库拷贝给其他虚拟机</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Node%E8%8A%82%E7%82%B9%E5%AE%89%E8%A3%85gluster"><span class="toc-number">1.2.5.</span> <span class="toc-text">5.Node节点安装gluster</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">设置开机自启动，并且检查服务运行状态</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Master%E8%8A%82%E7%82%B9%E5%AE%89%E8%A3%85gluster"><span class="toc-number">1.2.6.</span> <span class="toc-text">6.Master节点安装gluster</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%88%9B%E5%BB%BAgluster%E9%9B%86%E7%BE%A4"><span class="toc-number">1.2.7.</span> <span class="toc-text">7.创建gluster集群</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E7%8A%B6%E6%80%81"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">查看集群状态</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%A0%BC%E5%BC%8F%E5%8C%96%E7%A3%81%E7%9B%98"><span class="toc-number">1.3.</span> <span class="toc-text">三、格式化磁盘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%89%80%E6%9C%89node%E8%8A%82%E7%82%B9%E5%90%8E%E6%B7%BB%E5%8A%A0%E7%9A%844%E5%9D%97%E7%A1%AC%E7%9B%98"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.格式化所有node节点后添加的4块硬盘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E6%8C%82%E8%BD%BD%E7%82%B9-%E6%8C%82%E8%BD%BD%E7%9B%AE%E5%BD%95"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.创建挂载点(挂载目录)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AE%E6%B0%B8%E4%B9%85%E6%8C%82%E8%BD%BD"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.配置永久挂载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96node%E8%8A%82%E7%82%B9%E9%85%8D%E7%BD%AE%E6%B0%B8%E4%B9%85%E6%8C%82%E8%BD%BD"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">其他node节点配置永久挂载</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81volume%E5%8D%B7%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.</span> <span class="toc-text">四、volume卷类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E5%8D%B7distributed-volume"><span class="toc-number">1.4.1.</span> <span class="toc-text">1.分布式卷distributed volume</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-%E5%88%9B%E5%BB%BAbrick"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">A.创建brick</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#B-%E5%88%9B%E5%BB%BAvolume%E5%8D%B7"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">B.创建volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E5%90%AF%E5%8A%A8volume%E5%8D%B7"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">C.启动volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#D-%E6%9F%A5%E7%9C%8B%E5%88%9A%E5%88%9A%E5%88%9B%E5%BB%BA%E7%9A%84volume%E5%8D%B7%E4%BF%A1%E6%81%AF"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">D.查看刚刚创建的volume卷信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#E-%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E9%9B%86%E7%BE%A4%E5%AD%98%E5%9C%A8%E7%9A%84volume%E5%8D%B7"><span class="toc-number">1.4.1.5.</span> <span class="toc-text">E.查看当前集群存在的volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F-Master%E4%B8%BB%E6%9C%BA%E6%B5%8B%E8%AF%95%E6%8C%82%E8%BD%BD"><span class="toc-number">1.4.1.6.</span> <span class="toc-text">F.Master主机测试挂载</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Master%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%86%99"><span class="toc-number">1.4.1.6.1.</span> <span class="toc-text">Master测试数据读写</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%90%8E%E5%8F%B0Node%E8%8A%82%E7%82%B9%E5%AD%98%E5%82%A8%E6%83%85%E5%86%B5"><span class="toc-number">1.4.1.6.2.</span> <span class="toc-text">查看后台Node节点存储情况</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%8D%E5%88%B6%E5%8D%B7replicate-volume"><span class="toc-number">1.4.2.</span> <span class="toc-text">2.复制卷replicate volume</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-%E5%88%9B%E5%BB%BAbrick-1"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">A.创建brick</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#B-%E5%88%9B%E5%BB%BAvolume%E5%8D%B7-1"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">B.创建volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E5%90%AF%E5%8A%A8volume%E5%8D%B7-1"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">C.启动volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#D-%E6%9F%A5%E7%9C%8Bvolume%E5%8D%B7%E4%BF%A1%E6%81%AF"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">D.查看volume卷信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#E-%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E9%9B%86%E7%BE%A4%E6%89%80%E6%9C%89%E5%8D%B7%E7%BB%84"><span class="toc-number">1.4.2.5.</span> <span class="toc-text">E.查看当前集群所有卷组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F-Master%E8%8A%82%E7%82%B9%E6%8C%82%E8%BD%BD%E6%B5%8B%E8%AF%95"><span class="toc-number">1.4.2.6.</span> <span class="toc-text">F.Master节点挂载测试</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%86%99"><span class="toc-number">1.4.2.6.1.</span> <span class="toc-text">测试数据读写</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%90%8E%E7%AB%AFNode%E8%8A%82%E7%82%B9"><span class="toc-number">1.4.2.6.2.</span> <span class="toc-text">查看后端Node节点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%8D%E5%88%B6%E5%8D%B7Distributed-replicate"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.分布式复制卷Distributed-replicate</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-%E5%88%9B%E5%BB%BAbrick-2"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">A.创建brick</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#B-%E5%88%9B%E5%BB%BAvolume%E5%8D%B7-2"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">B.创建volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E5%90%AF%E5%8A%A8volume%E5%8D%B7-2"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">C.启动volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#D-%E6%9F%A5%E7%9C%8Bvolume%E5%8D%B7%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">D.查看volume卷详细信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#E-%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E9%9B%86%E7%BE%A4volume%E5%8D%B7"><span class="toc-number">1.4.3.5.</span> <span class="toc-text">E.查看当前集群volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F-Master%E8%8A%82%E7%82%B9%E6%8C%82%E8%BD%BD"><span class="toc-number">1.4.3.6.</span> <span class="toc-text">F.Master节点挂载</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%86%99-1"><span class="toc-number">1.4.3.6.1.</span> <span class="toc-text">测试数据读写</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%90%8E%E7%AB%AFNode%E8%8A%82%E7%82%B9-1"><span class="toc-number">1.4.3.6.2.</span> <span class="toc-text">查看后端Node节点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%86%E6%95%A3%E5%8D%B7Disperse"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.分散卷Disperse</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-%E5%88%9B%E5%BB%BAbrick-3"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">A.创建brick</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#B-%E5%88%9B%E5%BB%BAvolume%E5%8D%B7-3"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">B.创建volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E5%90%AF%E5%8A%A8volume%E5%8D%B7-3"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">C.启动volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#D-%E6%9F%A5%E7%9C%8Bvolume%E5%8D%B7%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF-1"><span class="toc-number">1.4.4.4.</span> <span class="toc-text">D.查看volume卷详细信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#E-%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E9%9B%86%E7%BE%A4%E7%9A%84%E6%89%80%E6%9C%89volume%E5%8D%B7"><span class="toc-number">1.4.4.5.</span> <span class="toc-text">E.查看当前集群的所有volume卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F-Master%E8%8A%82%E7%82%B9%E6%8C%82%E8%BD%BD-1"><span class="toc-number">1.4.4.6.</span> <span class="toc-text">F.Master节点挂载</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%86%99-2"><span class="toc-number">1.4.4.6.1.</span> <span class="toc-text">测试数据读写</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%90%8E%E7%AB%AFNode%E8%8A%82%E7%82%B9-2"><span class="toc-number">1.4.4.6.2.</span> <span class="toc-text">查看后端Node节点</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%89%A9%E5%AE%B9%E5%8D%B7%E5%AE%B9%E9%87%8F"><span class="toc-number">1.5.</span> <span class="toc-text">五、扩容卷容量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%89%A9%E5%B1%95%E5%8D%B7%E5%AE%B9%E9%87%8F"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.扩展卷容量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%89%A9%E5%AE%B9%E5%88%86%E5%B8%83%E5%BC%8F%E5%8D%B7"><span class="toc-number">1.5.2.</span> <span class="toc-text">2.扩容分布式卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Master%E8%8A%82%E7%82%B9%E6%B5%8B%E8%AF%95"><span class="toc-number">1.5.3.</span> <span class="toc-text">3.Master节点测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9F%A5%E7%9C%8B%E5%90%8E%E7%AB%AFNode%E8%8A%82%E7%82%B9"><span class="toc-number">1.5.4.</span> <span class="toc-text">4.查看后端Node节点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E7%BC%A9%E5%87%8F%E5%8D%B7%E5%AE%B9%E9%87%8F"><span class="toc-number">1.6.</span> <span class="toc-text">六、缩减卷容量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BC%A9%E5%87%8F%E5%88%86%E5%B8%83%E5%BC%8F%E5%8D%B7"><span class="toc-number">1.6.1.</span> <span class="toc-text">1.缩减分布式卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E7%8A%B6%E6%80%81"><span class="toc-number">1.6.2.</span> <span class="toc-text">2.查看状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9F%A5%E7%9C%8B%E5%8D%B7%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-number">1.6.3.</span> <span class="toc-text">3.查看卷详细信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8F%90%E4%BA%A4%E4%BF%AE%E6%94%B9"><span class="toc-number">1.6.4.</span> <span class="toc-text">4.提交修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%86%8D%E6%AC%A1%E6%9F%A5%E7%9C%8B%E5%8D%B7%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-number">1.6.5.</span> <span class="toc-text">5.再次查看卷详细信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%9B%BF%E6%8D%A2%E6%95%85%E9%9A%9C%E5%8D%B7Replace-faulty-brick"><span class="toc-number">1.7.</span> <span class="toc-text">七、替换故障卷Replace faulty brick</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9B%BF%E6%8D%A2%E5%88%86%E5%B8%83%E5%8D%B7%E7%9A%84brick"><span class="toc-number">1.7.1.</span> <span class="toc-text">1.替换分布卷的brick</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9B%BF%E6%8D%A2%E6%97%A7%E7%9A%84%E6%95%85%E9%9A%9C%E5%8D%B7"><span class="toc-number">1.7.2.</span> <span class="toc-text">2.替换旧的故障卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9F%A5%E7%9C%8B%E5%8D%B7%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF-1"><span class="toc-number">1.7.3.</span> <span class="toc-text">3.查看卷详细信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E8%AE%BE%E7%BD%AE%E5%8D%B7%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">1.8.</span> <span class="toc-text">八、设置卷的参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">1.8.1.</span> <span class="toc-text">1.常用参数</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/06/02/132/" title="【容器应用系列教程】容器介绍、Docker的安装和基本操作"><img src="/medias/loading.gif" data-original="https://www.dmoe.cc/random.php" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【容器应用系列教程】容器介绍、Docker的安装和基本操作"/></a><div class="content"><a class="title" href="/2023/06/02/132/" title="【容器应用系列教程】容器介绍、Docker的安装和基本操作">【容器应用系列教程】容器介绍、Docker的安装和基本操作</a><time datetime="2023-06-02T02:59:37.570Z" title="发表于 2023-06-02 10:59:37">2023-06-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/01/131/" title="【虚拟化应用系列教程】OpenStack组件"><img src="/medias/loading.gif" data-original="https://api.ghser.com/random/api.php" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【虚拟化应用系列教程】OpenStack组件"/></a><div class="content"><a class="title" href="/2023/06/01/131/" title="【虚拟化应用系列教程】OpenStack组件">【虚拟化应用系列教程】OpenStack组件</a><time datetime="2023-06-01T09:41:14.757Z" title="发表于 2023-06-01 17:41:14">2023-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/31/130/" title="【虚拟化应用系列教程】KVM存储管理"><img src="/medias/loading.gif" data-original="https://www.dmoe.cc/random.php" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【虚拟化应用系列教程】KVM存储管理"/></a><div class="content"><a class="title" href="/2023/05/31/130/" title="【虚拟化应用系列教程】KVM存储管理">【虚拟化应用系列教程】KVM存储管理</a><time datetime="2023-05-31T07:33:09.421Z" title="发表于 2023-05-31 15:33:09">2023-05-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/31/129/" title="【虚拟化应用系列教程】KVM网络管理"><img src="/medias/loading.gif" data-original="https://api.ghser.com/random/api.php" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【虚拟化应用系列教程】KVM网络管理"/></a><div class="content"><a class="title" href="/2023/05/31/129/" title="【虚拟化应用系列教程】KVM网络管理">【虚拟化应用系列教程】KVM网络管理</a><time datetime="2023-05-31T05:20:18.393Z" title="发表于 2023-05-31 13:20:18">2023-05-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/30/128/" title="【虚拟化应用系列教程】KVM虚拟机管理"><img src="/medias/loading.gif" data-original="https://www.dmoe.cc/random.php" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【虚拟化应用系列教程】KVM虚拟机管理"/></a><div class="content"><a class="title" href="/2023/05/30/128/" title="【虚拟化应用系列教程】KVM虚拟机管理">【虚拟化应用系列教程】KVM虚拟机管理</a><time datetime="2023-05-30T10:46:29.825Z" title="发表于 2023-05-30 18:46:29">2023-05-30</time></div></div></div></div></div></div></main><footer id="footer" style="background: flase"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 网笙久久</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=i;var e=n.imageLazyLoadSetting.isSPA,r=(n.imageLazyLoadSetting.preloadRatio,Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));function i(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight+240||document.documentElement.clientHeight+240)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},t.src!==i&&(n.src=i)}()}i(),n.addEventListener("scroll",function(){var t,e;t=i,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>